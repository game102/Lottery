{"version":3,"sources":["assets\\Script\\TableManager.js"],"names":["cc","Class","extends","Component","properties","run_node","type","Node","default","item_root","start","start_index","Math","random","children","length","floor","setPosition","getPosition","is_run","console","log","start_click","end_index","show_run_anim","turns","run_path","i","push","j","step_speed","damp","path_next_index","run_to_next","time_passed","dst","src","dir","sub","len","mag","step_time","x","y","update","dt"],"mappings":"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","file":"unknown","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        run_node: {\r\n\t\t\ttype: cc.Node,\r\n\t\t\tdefault: null,\r\n        },\r\n\r\n        item_root: {\r\n        \ttype: cc.Node,\r\n        \tdefault: null,\r\n        },\r\n    },\r\n\r\n    start() {\r\n    \tthis.start_index = Math.random() * this.item_root.children.length; //[0 12)\r\n    \tthis.start_index = Math.floor(this.start_index);\r\n    \tthis.run_node.setPosition(this.item_root.children[this.start_index].getPosition());\r\n\r\n    \tthis.is_run = false;\r\n\r\n    \tconsole.log(\"start_index:\" + this.start_index);\r\n    },\r\n\r\n    start_click() {\r\n    \tthis.end_index = Math.random() * this.item_root.children.length; //[0 12)\r\n    \tthis.end_index = Math.floor(this.end_index);\r\n\r\n    \tthis.is_run = true;\r\n    \tthis.show_run_anim();\r\n\r\n    \tconsole.log(\"end_index:\" + this.end_index);\r\n    },\r\n\r\n    show_run_anim() {\r\n\r\n    \tthis.turns = Math.random() * 2; //[0 2)\r\n\t\tthis.turns = Math.floor(this.turns) + 2;\r\n\r\n    \tthis.run_path = [];\r\n\r\n    \tfor(var i = this.start_index; i < this.item_root.children.length; i++)\r\n    \t{\r\n    \t\tthis.run_path.push(this.item_root.children[i]);\r\n    \t}\r\n\r\n    \tfor(var j = 0; j < this.turns; j++)\r\n    \t{\r\n    \t\tfor(var i = 0; i < this.item_root.children.length; i++)\r\n\t    \t{\r\n\t    \t\tthis.run_path.push(this.item_root.children[i]);\r\n\t    \t}\r\n    \t}\r\n\r\n    \tfor(var i = 0; i < this.end_index; i++)\r\n    \t{\r\n    \t\tthis.run_path.push(this.item_root.children[i]);\r\n    \t}\r\n\r\n    \tthis.step_speed = 5000;\r\n    \tthis.damp = this.step_speed / (this.run_path.length - 1);\r\n    \tthis.path_next_index = 1;\r\n\r\n    \tthis.run_to_next();\r\n    },\r\n\r\n    run_to_next() {\r\n\r\n    \tif(this.path_next_index >= this.run_path.length)\r\n    \t{\r\n    \t\tthis.is_run = false;\r\n    \t\tthis.start_index = this.end_index;\r\n    \t\treturn;\r\n    \t}\r\n\r\n    \tthis.time_passed = 0;\r\n\r\n    \tvar dst = this.run_path[this.path_next_index].getPosition();\r\n    \tvar src = this.run_node.getPosition();\r\n    \tvar dir = dst.sub(src);\r\n    \tvar len = dir.mag();\r\n\r\n    \tthis.step_time = len / this.step_speed;\r\n\r\n    \tthis.run_node.x += dir.x;\r\n    \tthis.run_node.y += dir.y;\r\n\r\n\t\tthis.step_speed -= this.damp;\r\n\t\tthis.path_next_index++;\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n\r\n    \tif(!this.is_run)\r\n    \t{\r\n    \t\treturn;\r\n    \t}\r\n\r\n\t\tthis.time_passed += dt;\r\n\r\n\t\tif(this.time_passed > this.step_time)\r\n\t\t{\r\n\t\t\tdt -= (this.time_passed-this.step_time);\r\n\t\t}\r\n\r\n\t\tif(this.time_passed >= this.step_time)\r\n\t\t{\r\n\t\t\tthis.run_to_next();\r\n\t\t}\r\n    },\r\n\r\n});\r\n"]}